<!DOCTYPE html>
<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<head>

	<title> Stock Historical Data over Time</title>
</head>
<body onload="init()">
	<h1>Stock Historical Data over Time</h1>
	<svg width=800 height=700>
	</svg>
	<script>
		async function init() {
			stockId = 'qqq';
			const data = await d3.csv('Data/MSFT_Placeholder.csv');//3
			//const data = await d3.csv("https://www.nasdaq.com/api/v1/historical/QQQ/etf/2010-07-19/2020-07-19");
			//dateString = data.map(function(d) {return d.Date; });
			dates = data.map(function(d) {return new Date(d.Date); });
			console.log(dates);
			closes = data.map(function(d) {return Number.parseFloat(d.Close); });
			volume = data.map(function(d) {return parseInt(d.Volume);});
			open = data.map(function(d) {return parseFloat(d.Open);});
			High = data.map(function(d) {return parseFloat(d.High);});
			Low = data.map(function(d) {return parseFloat(d.Low);});			
			console.log(closes);
			// console.log(volume);
			// console.log(open);
			// console.log(High);
			// console.log(Low);
			 xMin = Math.min.apply(null, dates);
			 xMax = Math.max.apply(null, dates);
			 yMin = Math.min.apply(null, closes);
			 yMax = Math.max.apply(null, closes);
			// yMin2 = Math.min.apply(null, prices2);
			// yMax2 = Math.max.apply(null, prices2);
			 console.log(xMin);
			 console.log(xMax);
			// console.log(yMin);
			// console.log(yMax);
			// console.log(yMin2);
			// console.log(yMax2);
			
			// console.log(volume2);
			// console.log(volume3);

			w = 600;
			h = 600;
			color = 'Green';

			var xScale = d3.scaleLinear().domain([xMin, xMax]).range([0, w]);
			var yScale = d3.scaleLinear().domain([yMin, yMax]).range([h, 0]);

            var xAxis = d3.axisBottom(xScale);
            var yAxis = d3.axisLeft(yScale);

			var line = d3.line()
					     .x(function(d,i) {return xScale(i);})
					     .y(function(d) {return yScale(d.Close); });

			d3.select('svg')
			  .append('g')
			  .attr("transform", "translate(50, 50)")
			  .data(data)
			  .attr("d", line)
			  .attr("class", "line")
			  .attr("stroke", color);
			d3.select("svg")
			  .append("g")
			  .attr("transform", "translate(50, 50)")
			  .style("font", "14px times")
			  .call(yAxis);
			d3.select("svg")
			  .append("g")
			  .attr("transform", "translate(50, 50)")
			  .style("font", "14px times")
			  .call(xAxis);
			/*marker = d3.select("svg")
			           .append("g")
			           .attr("transform", "translate(50,50)")
			           .selectAll("circle")
			           .data(data)
			           .enter()
			           .attr("class", "dot")
			           .attr("cx", function(d, i) {return i;})
			           .attr("cy", function(d, i) {return yScale(d.Close);})
			           .attr("r", 4)
			           .attr("fill", color);
*/
		}
	</script>
</body>
</html>
